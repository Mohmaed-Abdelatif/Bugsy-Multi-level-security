# public/.htaccess (hyper text access) used by the Apache web server, like a firewall layer before php
#in root .htaccess ,make the public folder is the entry point to hidde sesitive folders and files to be accessed
#but urls(endpoints) that will user frontend will use will be ugly exm: index.php?url=api/v1/products
#so will solve it with make our pattern of endpoints url, doesn't exist in reel structure but will handel it her to go to index.php the app.php to be handeld
#------------------------------------
#clean URLs
#------------------------------------

#if rewrite module exists
<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # If the requested file exists, serve it directly
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    
    # Otherwise, route through index.php
    #^(.*)$ => it matches any URL:    /users/1, /api/v1/cart, etc.
    #index.php?url=$1  =>It redirects everything to index.php and passes the original path as a query parameter called url.
    #so, " /api/v1/products/5 "  becomes: " index.php?url=api/v1/products/5 "
    #QSA (Query String Append): keeps existing query parameters /products?category=phones => index.php?url=products&category=phones
    #L (Last): means “stop processing other rewrite rules after this one”
    #thin PHP router (inside App.php) will then read $_GET['url'] and decide which controller and method to call.
    RewriteRule ^(.*)$ index.php?url=$1 [QSA,L]
</IfModule>
#summary: If the user requests a file or folder that doesn’t exist(or style of our endpoints that will use in front),send the request to index.php and let PHP handle it.



#------------------------------------
#security headers: modify HTTP headers in the response before it reaches the browser.
#------------------------------------

# <IfModule mod_headers.c>
#     # Prevent clickjacking : only this site with this domin can display this site in iframe
#     Header always set X-Frame-Options "SAMEORIGIN"
    
#     # Prevent MIME type sniffing : don't guess If you serve a .js file, it will only be treated as JS, not HTML or something else.
#     Header always set X-Content-Type-Options "nosniff"
    
#     # Enable XSS protection : “If the browser detects a possible XSS attack, block the page entirely instead of trying to sanitize it.”
#     Header always set X-XSS-Protection "1; mode=block"
# </IfModule>



#-------------------------------------
#cache control (for images/statc files)
#-------------------------------------

<IfModule mod_expires.c>
    ExpiresActive On
    
    # Images cache for 1 month
    ExpiresByType image/jpeg "access plus 1 month"
    ExpiresByType image/png "access plus 1 month"
    ExpiresByType image/gif "access plus 1 month"
    
    # CSS/JS cache for 1 week
    ExpiresByType text/css "access plus 1 week"
    ExpiresByType application/javascript "access plus 1 week"
</IfModule>

